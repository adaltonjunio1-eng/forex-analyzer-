<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Forex Analyzer</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: #0a0a0f; color: white; font-family: Arial; padding: 20px; }
        .chart-container { width: 100%; height: 400px; background: #1a1a2e; padding: 20px; border-radius: 10px; margin: 20px 0; }
        button { background: #0052ff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 10px; }
        .stats { display: flex; gap: 20px; margin: 20px 0; }
        .stat { background: #1a1a2e; padding: 15px; border-radius: 8px; text-align: center; }
    </style>
</head>
<body>
    <h1>üöÄ Forex Analyzer - Teste</h1>
    
    <div class="stats">
        <div class="stat">
            <h3 id="currentPrice">1.0850</h3>
            <p>Pre√ßo Atual</p>
        </div>
        <div class="stat">
            <h3 id="rsiValue">65.2</h3>
            <p>RSI</p>
        </div>
        <div class="stat">
            <h3 id="signalStatus">COMPRA</h3>
            <p>Sinal</p>
        </div>
    </div>

    <button onclick="analyzeMarket()">üîç Analisar Mercado</button>
    <button onclick="generateData()">üìä Gerar Dados</button>

    <div class="chart-container">
        <canvas id="testChart"></canvas>
    </div>

    <div id="output" style="background: #1a1a2e; padding: 20px; border-radius: 8px; margin-top: 20px;">
        <h3>Log de Teste:</h3>
        <div id="logOutput"></div>
    </div>

    <script>
        let testData = [];
        let chart = null;

        // Fun√ß√£o de log
        function log(message) {
            const output = document.getElementById('logOutput');
            const timestamp = new Date().toLocaleTimeString();
            output.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            console.log(message);
        }

        // Gerar dados mockados
        function generateData() {
            log('Gerando dados de teste...');
            testData = [];
            let basePrice = 1.0850;
            
            for (let i = 0; i < 50; i++) {
                const change = (Math.random() - 0.5) * 0.002;
                basePrice += change;
                
                const open = basePrice;
                const high = open + Math.random() * 0.001;
                const low = open - Math.random() * 0.001;
                const close = low + Math.random() * (high - low);
                
                testData.push({
                    timestamp: Date.now() - (50 - i) * 60000,
                    open: parseFloat(open.toFixed(5)),
                    high: parseFloat(high.toFixed(5)),
                    low: parseFloat(low.toFixed(5)),
                    close: parseFloat(close.toFixed(5)),
                    volume: Math.round(Math.random() * 5000 + 1000)
                });
            }
            
            log(`‚úÖ ${testData.length} candles gerados`);
            updateChart();
        }

        // Atualizar gr√°fico
        function updateChart() {
            const ctx = document.getElementById('testChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }

            const labels = testData.map((_, index) => `${index + 1}`);
            const prices = testData.map(candle => candle.close);

            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Pre√ßo (EUR/USD)',
                        data: prices,
                        borderColor: '#0052ff',
                        backgroundColor: 'rgba(0, 82, 255, 0.1)',
                        fill: true,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: '#ffffff' }
                        }
                    },
                    scales: {
                        x: {
                            ticks: { color: '#b3b3cc' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        y: {
                            ticks: { 
                                color: '#b3b3cc',
                                callback: function(value) {
                                    return value.toFixed(5);
                                }
                            },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    }
                }
            });

            log('üìä Gr√°fico atualizado com sucesso');
        }

        // Simular an√°lise
        function analyzeMarket() {
            log('üîç Iniciando an√°lise...');
            
            if (testData.length === 0) {
                log('‚ö†Ô∏è Nenhum dado dispon√≠vel. Gerando dados primeiro...');
                generateData();
                return;
            }

            // Simular c√°lculo de RSI
            const prices = testData.map(c => c.close);
            const lastPrice = prices[prices.length - 1];
            const avgPrice = prices.reduce((a, b) => a + b, 0) / prices.length;
            const rsi = 50 + (lastPrice - avgPrice) * 1000; // Simula√ß√£o simples
            
            // Atualizar UI
            document.getElementById('currentPrice').textContent = lastPrice.toFixed(5);
            document.getElementById('rsiValue').textContent = Math.max(0, Math.min(100, rsi)).toFixed(1);
            
            const signal = rsi > 70 ? 'VENDA' : rsi < 30 ? 'COMPRA' : 'NEUTRO';
            document.getElementById('signalStatus').textContent = signal;
            
            log(`‚úÖ An√°lise conclu√≠da - RSI: ${rsi.toFixed(1)}, Sinal: ${signal}`);
        }

        // Inicializar
        window.onload = function() {
            log('üöÄ Teste do Forex Analyzer carregado');
            log('üéØ Clique em "Gerar Dados" para come√ßar');
        };
    </script>
</body>
</html>