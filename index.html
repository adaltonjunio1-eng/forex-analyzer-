<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Forex Candle Strength Analyzer</title>
    
    <!-- PWA Meta Tags -->
    <meta name="application-name" content="Forex Analyzer">
    <meta name="description" content="Aplicativo de an√°lise de for√ßa de candles no mercado forex com indicadores t√©cnicos em tempo real">
    <meta name="keywords" content="forex, trading, candlestick, analysis, technical indicators, PWA">
    <meta name="author" content="Forex Analyzer Team">
    
    <!-- PWA Display -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Forex Analyzer">
    <meta name="msapplication-TileColor" content="#0052ff">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- Theme Colors -->
    <meta name="theme-color" content="#0052ff">
    <meta name="msapplication-navbutton-color" content="#0052ff">
    <meta name="apple-mobile-web-app-status-bar-style" content="#0052ff">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="assets/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="assets/icon-512.png">
    <link rel="apple-touch-icon" sizes="192x192" href="assets/icon-192.png">
    <link rel="apple-touch-icon" sizes="512x512" href="assets/icon-512.png">
    <link rel="shortcut icon" href="assets/icon-192.png">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="css/style.css" as="style">
    <link rel="preload" href="js/app.js" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/chart.js" as="script">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fas fa-chart-line"></i>
                <span>Forex Analyzer</span>
            </div>
            <nav class="nav">
                <ul class="nav-list">
                    <li><a href="#dashboard" class="nav-link active">Dashboard</a></li>
                    <li><a href="#analysis" class="nav-link">An√°lise</a></li>
                    <li><a href="#news" class="nav-link">Not√≠cias</a></li>
                    <li><a href="#signals" class="nav-link">Sinais</a></li>
                    <li><a href="#settings" class="nav-link">Configura√ß√µes</a></li>
                </ul>
            </nav>
            <div class="mobile-menu">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <div class="container">
                <h1 class="section-title">Dashboard de An√°lise Forex</h1>
                
                <!-- Currency Selector -->
                <div class="currency-selector">
                    <select id="currencyPair" class="currency-select">
                        <optgroup label="üî• Majors - Principais">
                            <option value="EURUSD">EUR/USD - Euro vs D√≥lar</option>
                            <option value="GBPUSD">GBP/USD - Libra vs D√≥lar</option>
                            <option value="USDJPY">USD/JPY - D√≥lar vs Iene</option>
                            <option value="USDCHF">USD/CHF - D√≥lar vs Franco</option>
                            <option value="AUDUSD">AUD/USD - D√≥lar Australiano</option>
                            <option value="USDCAD">USD/CAD - D√≥lar vs Canadense</option>
                            <option value="NZDUSD">NZD/USD - D√≥lar Neozeland√™s</option>
                            <option value="NZDUSD">EUR/CAD - D√≥lar vs Canadense</option>
                        </optgroup>
                        <optgroup label="üíé Metais Preciosos">
                            <option value="XAUUSD">XAU/USD - Ouro vs D√≥lar</option>
                            <option value="XAGUSD">XAG/USD - Prata vs D√≥lar</option>
                        </optgroup>
                        <optgroup label="‚ö° Cross Rates - Cruzados">
                            <option value="EURJPY">EUR/JPY - Euro vs Iene</option>
                            <option value="EURGBP">EUR/GBP - Euro vs Libra</option>
                            <option value="EURAUD">EUR/AUD - Euro vs D√≥lar Australiano</option>
                            <option value="EURCHF">EUR/CHF - Euro vs Franco</option>
                            <option value="GBPJPY">GBP/JPY - Libra vs Iene</option>
                            <option value="GBPAUD">GBP/AUD - Libra vs D√≥lar Australiano</option>
                            <option value="GBPCHF">GBP/CHF - Libra vs Franco</option>
                            <option value="AUDJPY">AUD/JPY - D√≥lar Australiano vs Iene</option>
                            <option value="NZDJPY">NZD/JPY - D√≥lar Neozeland√™s vs Iene</option>
                            <option value="CADJPY">CAD/JPY - D√≥lar Canadense vs Iene</option>
                            <option value="CHFJPY">CHF/JPY - Franco vs Iene</option>
                        </optgroup>
                        <optgroup label="üåç Emergentes & Ex√≥ticos">
                            <option value="USDBRL">USD/BRL - D√≥lar vs Real</option>
                            <option value="USDMXN">USD/MXN - D√≥lar vs Peso Mexicano</option>
                            <option value="USDZAR">USD/ZAR - D√≥lar vs Rand Sul-Africano</option>
                            <option value="USDTRY">USD/TRY - D√≥lar vs Lira Turca</option>
                            <option value="USDSGD">USD/SGD - D√≥lar vs D√≥lar Singapura</option>
                            <option value="USDHKD">USD/HKD - D√≥lar vs D√≥lar Hong Kong</option>
                        </optgroup>
                        <optgroup label="üìä √çndices">
                            <option value="US30">US30 - Dow Jones</option>
                            <option value="US100">US100 - Nasdaq</option>
                            <option value="US500">US500 - S&P 500</option>
                            <option value="GER40">GER40 - DAX</option>
                            <option value="UK100">UK100 - FTSE 100</option>
                            <option value="JPN225">JPN225 - Nikkei</option>
                        </optgroup>
                        <optgroup label="ü™ô Criptomoedas">
                            <option value="BTCUSD">BTC/USD - Bitcoin</option>
                            <option value="ETHUSD">ETH/USD - Ethereum</option>
                            <option value="XRPUSD">XRP/USD - Ripple</option>
                        </optgroup>
                        <optgroup label="‚õΩ Commodities">
                            <option value="USOIL">US OIL - Petr√≥leo WTI</option>
                            <option value="UKOIL">UK OIL - Petr√≥leo Brent</option>
                        </optgroup>
                    </select>
                    <select id="timeframe" class="timeframe-select">
                        <option value="M1">1 Minuto</option>
                        <option value="M5">5 Minutos</option>
                        <option value="M15">15 Minutos</option>
                        <option value="M30">30 Minutos</option>
                        <option value="H1" selected>1 Hora</option>
                        <option value="H4">4 Horas</option>
                        <option value="D1">1 Dia</option>
                    </select>
                    <button id="analyzeBtn" class="analyze-btn">
                        <i class="fas fa-search"></i>
                        Analisar
                    </button>
                </div>

                <!-- Quick Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-trending-up"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="currentPrice">1.0850</h3>
                            <p>Pre√ßo Atual</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="candleStrength">75%</h3>
                            <p>For√ßa do Candle</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-signal"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="signalStatus">COMPRA</h3>
                            <p>Sinal Atual</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-percent"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="rsiValue">65.2</h3>
                            <p>RSI</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <div class="stat-content">
                            <div id="divergenceStatus" class="divergence-inactive">
                                <span class="div-none">Nenhuma diverg√™ncia</span>
                            </div>
                            <p>Diverg√™ncia RSI</p>
                        </div>
                    </div>

                    <!-- Pullback Indicator Card -->
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-content">
                            <div id="pullbackStatus" class="pullback-inactive">
                                üí§ Aguardando Rompimento
                            </div>
                            <p>Pullback Avan√ßado</p>
                        </div>
                    </div>

                    <!-- Pullback Multi-Signal Card -->
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-layer-group"></i>
                        </div>
                        <div class="stat-content">
                            <div id="pullbackMultiStatus" class="pullback-multi-inactive">
                                üîç Aguardando Sinais (0/4)
                            </div>
                            <p>Multi-Signal Pullback</p>
                        </div>
                    </div>
                </div>

                <!-- Chart Container -->
                <div class="chart-container">
                    <canvas id="forexChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Analysis Section -->
        <section id="analysis" class="section">
            <div class="container">
                <h1 class="section-title">An√°lise T√©cnica Detalhada</h1>
                
                <div class="analysis-grid">
                    <!-- Candle Pattern Analysis -->
                    <div class="analysis-card">
                        <h3><i class="fas fa-candle-holder"></i> Padr√µes de Candle</h3>
                        <div id="candlePatterns" class="patterns-list">
                            <div class="pattern-item">
                                <span class="pattern-name">Doji</span>
                                <span class="pattern-strength strong">Forte</span>
                            </div>
                            <div class="pattern-item">
                                <span class="pattern-name">Hammer</span>
                                <span class="pattern-strength medium">M√©dio</span>
                            </div>
                        </div>
                    </div>

                    <!-- Technical Indicators -->
                    <div class="analysis-card">
                        <h3><i class="fas fa-chart-line"></i> Indicadores T√©cnicos</h3>
                        <div class="indicators-list">
                            <div class="indicator-item">
                                <span class="indicator-name">RSI (14)</span>
                                <span class="indicator-value" id="rsiIndicator">65.2</span>
                                <div class="indicator-bar">
                                    <div class="indicator-fill" style="width: 65.2%"></div>
                                </div>
                            </div>
                            <div class="indicator-item">
                                <span class="indicator-name">MACD</span>
                                <span class="indicator-value" id="macdIndicator">+0.0025</span>
                                <div class="indicator-status bullish">Bullish</div>
                            </div>
                            <div class="indicator-item">
                                <span class="indicator-name">Bollinger</span>
                                <span class="indicator-value" id="bollingerIndicator">Meio</span>
                                <div class="indicator-status neutral">Neutral</div>
                            </div>
                        </div>
                    </div>

                    <!-- Volume Analysis -->
                    <div class="analysis-card">
                        <h3><i class="fas fa-volume-up"></i> An√°lise de Volume</h3>
                        <div class="volume-chart">
                            <canvas id="volumeChart"></canvas>
                        </div>
                    </div>

                    <!-- Support & Resistance -->
                    <div class="analysis-card">
                        <h3><i class="fas fa-layer-group"></i> Suporte & Resist√™ncia</h3>
                        <div class="levels-list">
                            <div class="level-item resistance">
                                <span class="level-type">Resist√™ncia</span>
                                <span class="level-price">1.0875</span>
                                <span class="level-strength">Forte</span>
                            </div>
                            <div class="level-item support">
                                <span class="level-type">Suporte</span>
                                <span class="level-price">1.0825</span>
                                <span class="level-strength">M√©dio</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- News Section -->
        <section id="news" class="section">
            <div class="container">
                <h1 class="section-title">üì∞ An√°lise de Not√≠cias Forex</h1>
                
                <div class="news-header">
                    <div class="news-filters">
                        <button class="news-filter-btn active" data-sentiment="all">
                            <i class="fas fa-globe"></i> Todas
                        </button>
                        <button class="news-filter-btn" data-sentiment="positive">
                            <i class="fas fa-arrow-up"></i> Positivas
                        </button>
                        <button class="news-filter-btn" data-sentiment="negative">
                            <i class="fas fa-arrow-down"></i> Negativas
                        </button>
                        <button class="news-filter-btn" data-sentiment="critical">
                            <i class="fas fa-exclamation-triangle"></i> Cr√≠ticas
                        </button>
                    </div>
                    <div class="news-controls">
                        <button id="refreshNews" class="refresh-news-btn">
                            <i class="fas fa-sync-alt"></i> Atualizar
                        </button>
                        <div class="auto-refresh-toggle">
                            <label>
                                <input type="checkbox" id="autoRefreshNews" checked>
                                <span>Auto-refresh</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- News Summary Cards -->
                <div class="news-summary">
                    <div class="summary-card positive">
                        <div class="summary-icon">üìà</div>
                        <div class="summary-content">
                            <h3 id="positiveCount">0</h3>
                            <p>Not√≠cias Positivas</p>
                        </div>
                    </div>
                    <div class="summary-card negative">
                        <div class="summary-icon">üìâ</div>
                        <div class="summary-content">
                            <h3 id="negativeCount">0</h3>
                            <p>Not√≠cias Negativas</p>
                        </div>
                    </div>
                    <div class="summary-card neutral">
                        <div class="summary-icon">‚ûñ</div>
                        <div class="summary-content">
                            <h3 id="neutralCount">0</h3>
                            <p>Not√≠cias Neutras</p>
                        </div>
                    </div>
                    <div class="summary-card critical">
                        <div class="summary-icon">üö®</div>
                        <div class="summary-content">
                            <h3 id="criticalCount">0</h3>
                            <p>Alertas Cr√≠ticos</p>
                        </div>
                    </div>
                </div>

                <!-- News Feed -->
                <div class="news-feed" id="newsFeed">
                    <!-- News items will be dynamically added here -->
                    <div class="news-loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Carregando not√≠cias...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Signals Section -->
        <section id="signals" class="section">
            <div class="container">
                <h1 class="section-title">Sinais de Trading</h1>
                
                <div class="signals-header">
                    <div class="signal-filters">
                        <button class="filter-btn active" data-filter="all">Todos</button>
                        <button class="filter-btn" data-filter="buy">Compra</button>
                        <button class="filter-btn" data-filter="sell">Venda</button>
                        <button class="filter-btn" data-filter="neutral">Neutro</button>
                    </div>
                    <div class="signal-settings">
                        <button id="alertsToggle" class="alerts-btn">
                            <i class="fas fa-bell"></i>
                            Alertas: ON
                        </button>
                    </div>
                </div>

                <div class="signals-list" id="signalsList">
                    <!-- Signals will be dynamically added here -->
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings" class="section">
            <div class="container">
                <h1 class="section-title">Configura√ß√µes</h1>
                
                <div class="settings-grid">
                    <div class="settings-card">
                        <h3><i class="fas fa-cog"></i> Configura√ß√µes Gerais</h3>
                        <div class="setting-item">
                            <label for="autoRefresh">Atualiza√ß√£o Autom√°tica</label>
                            <input type="checkbox" id="autoRefresh" checked>
                        </div>
                        <div class="setting-item">
                            <label for="refreshInterval">Intervalo (segundos)</label>
                            <input type="number" id="refreshInterval" value="30" min="5" max="300">
                        </div>
                        <div class="setting-item">
                            <label for="soundAlerts">Alertas Sonoros</label>
                            <input type="checkbox" id="soundAlerts">
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3><i class="fas fa-palette"></i> Apar√™ncia</h3>
                        <div class="setting-item">
                            <label for="theme">Tema</label>
                            <select id="theme">
                                <option value="dark">Escuro</option>
                                <option value="light">Claro</option>
                                <option value="auto">Autom√°tico</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="chartType">Tipo de Gr√°fico</label>
                            <select id="chartType">
                                <option value="candlestick">Candlestick</option>
                                <option value="line">Linha</option>
                                <option value="bar">Barras</option>
                            </select>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3><i class="fas fa-calculator"></i> Indicadores</h3>
                        <div class="setting-item">
                            <label for="rsiPeriod">Per√≠odo RSI</label>
                            <input type="number" id="rsiPeriod" value="14" min="5" max="50">
                        </div>
                        <div class="setting-item">
                            <label for="macdFast">MACD R√°pido</label>
                            <input type="number" id="macdFast" value="12" min="5" max="30">
                        </div>
                        <div class="setting-item">
                            <label for="macdSlow">MACD Lento</label>
                            <input type="number" id="macdSlow" value="26" min="15" max="50">
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Analisando dados...</p>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/indicators.js"></script>
    <script src="js/patterns.js"></script>
    <script src="js/signals.js"></script>
    <script src="js/news.js"></script>
    <script src="js/pullback.js"></script>
    <script src="js/pullback-multi.js"></script>
    <script src="js/chart.js"></script>
    <script src="js/app.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Register Service Worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('‚úÖ Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('Nova vers√£o dispon√≠vel! Atualizar agora?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('‚ùå Service Worker registration failed:', error);
                    });
            });
        }
        
        // PWA Install Prompt
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('üíæ PWA install prompt triggered');
            e.preventDefault();
            deferredPrompt = e;
            
            // Show custom install button
            const installBtn = document.createElement('button');
            installBtn.textContent = 'üì± Instalar App';
            installBtn.className = 'install-btn';
            installBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: #0052ff;
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 25px;
                font-weight: bold;
                cursor: pointer;
                box-shadow: 0 4px 15px rgba(0, 82, 255, 0.3);
                z-index: 1000;
                font-size: 14px;
                transition: all 0.3s ease;
            `;
            
            installBtn.addEventListener('mouseenter', () => {
                installBtn.style.transform = 'scale(1.05)';
                installBtn.style.boxShadow = '0 6px 20px rgba(0, 82, 255, 0.4)';
            });
            
            installBtn.addEventListener('mouseleave', () => {
                installBtn.style.transform = 'scale(1)';
                installBtn.style.boxShadow = '0 4px 15px rgba(0, 82, 255, 0.3)';
            });
            
            installBtn.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    
                    if (outcome === 'accepted') {
                        console.log('‚úÖ PWA installation accepted');
                        if (typeof Utils !== 'undefined') {
                            Utils.showToast('App instalado com sucesso!', 'success');
                        }
                    } else {
                        console.log('‚ùå PWA installation declined');
                    }
                    
                    deferredPrompt = null;
                    installBtn.remove();
                }
            });
            
            document.body.appendChild(installBtn);
            
            // Auto-hide after 10 seconds
            setTimeout(() => {
                if (installBtn.parentNode) {
                    installBtn.style.opacity = '0';
                    setTimeout(() => installBtn.remove(), 300);
                }
            }, 10000);
        });
        
        // PWA Installation Success
        window.addEventListener('appinstalled', () => {
            console.log('üéâ PWA installed successfully');
            if (typeof Utils !== 'undefined') {
                Utils.showToast('Forex Analyzer instalado!', 'success');
            }
        });
        
        // Handle offline/online status
        window.addEventListener('online', () => {
            console.log('üåê Back online');
            if (typeof Utils !== 'undefined') {
                Utils.showToast('Conectado novamente!', 'success');
            }
        });
        
        window.addEventListener('offline', () => {
            console.log('üìµ Gone offline');
            if (typeof Utils !== 'undefined') {
                Utils.showToast('Modo offline ativado', 'warning');
            }
        });
    </script>
</body>
</html>